// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

"use strict";

//------------------------------------------------------------------------------
// Requirements
//------------------------------------------------------------------------------

const rules = require('../../../lib/rules/avoid-ui-refreshribbon');
const RuleTester = require('eslint').RuleTester;

//------------------------------------------------------------------------------
// CONSTANTS
//------------------------------------------------------------------------------

const errors = [{messageId: 'refreshRibbonFound'}];

//------------------------------------------------------------------------------
// Helpers
//------------------------------------------------------------------------------

const ruleTester = new RuleTester();

ruleTester.run('avoid-ui-refreshribbon',rules,{
    valid :[
        {
            code : 'Xrm.Page.getformContext()',
        },
        {
            code: 'window.refreshRibbon()',
        },
        {
            code: 'Xrm.Internal.refreshRibbon()',
        }
    ],

    invalid :[
        {
            code: 'n.ui.refreshRibbon()',
            errors,
        },
        {
            code: 'Xrm.page.ui.refreshRibbon()',
            errors,
        },
        {
            code: 'formContext.ui.refreshRibbon()',
            errors,
        }
    ],

})


